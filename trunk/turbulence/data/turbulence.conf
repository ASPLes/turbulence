<?xml version='1.0' ?>
<!-- turbulence default configuration -->
<turbulence>

  <global-settings>
    <!-- port allocation configuration -->
    <ports>
      <port>3206</port>
    </ports>
    
    <!-- log reporting configuration -->
    <log-reporting enabled="yes">
      <general-log file="/var/log/turbulence/main.log" />
      <error-log  file="/var/log/turbulence/error.log" />
      <access-log file="/var/log/turbulence/access.log" />
      <vortex-log file="/var/log/turbulence/vortex.log" />
    </log-reporting>

    <!-- building profiles support -->
    <tls-support enabled="yes" />

    <!-- crash settings 
       [*] hold:   lock the current instace so a developer can attach to the
                   process  to debug what's happening.

       [*] ignore: just ingore the signal, and try to keep running.

       [*] quit,exit: terminates turbulence execution.
     -->
    <on-bad-signal action="hold" />
    
  </global-settings>

  <modules>
    <!-- directory where to find modules to load -->
    <directory src="/etc/turbulence/mods-enabled" /> 

    <!-- modules to be filtered (not loaded, even found at the modules directory) -->
    <filter-modules>
      <by-module name="filtered_module.so" />
    </filter-modules>
    
  </modules>
  
  <listener>
    <name>0.0.0.0</name>
  </listener>

  <profile-path-configuration>
    <!-- allow all from all, without any limitation -->
<!--    <path-def server-name=".*" src=".*" path-name="free-for-all" > 
      <allow profile=".*" />
    </path-def> -->
    
    <!-- profile path for all connections comming from the outside -->
    <path-def server-name=".*" src="127.*" path-name="localhost">
      
      <if-success profile="http://iana.org/beep/SASL/*" >
	<allow profile="http://turbulence.ws/profiles/test1" />
	<if-success profile="http://iana.org/beep/TLS" >
	  <allow profile="http://iana.org/beep/xmlrpc" />
	  <allow profile="http://fact.aspl.es/profiles/coyote_profile" />
	</if-success>
      </if-success>
    </path-def>

    
    <!-- profile path for all connections comming from the outside -->
    <path-def server-name=".*" src="192.168.0.*" path-name="local-parts">
      
      <if-success profile="http://iana.org/beep/SASL/*" >
	<if-success profile="http://iana.org/beep/TLS" >
	  <allow profile="http://iana.org/beep/xmlrpc" />
	  <allow profile="http://fact.aspl.es/profiles/coyote_profile" />
	</if-success>
      </if-success>
    </path-def>
    
    <!-- profile path for all connections comming from the outside -->
    <path-def server-name=".*" src="! 192.168.0.*" path-name="not local-parts">
      <if-success profile="http://iana.org/beep/SASL/*" >
	<allow profile="http://iana.org/beep/TUNNEL" />
      </if-success>
    </path-def>
    
  </profile-path-configuration>
  
</turbulence>
